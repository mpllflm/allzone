<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Money Plant Link Pvt. Ltd. FLM Call & Traveling Bill Management</title>
  <style>
    /* Global Styles */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #1f1c2c, #928dab);
      color: #e0e0e0;
      padding: 20px;
      text-align: center;
    }

    header img {
      width: 120px;
      margin: 10px auto;
    }

    header h1 {
      font-size: 1.8em;
      color: #f1c40f;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .form-container {
      background: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 10px;
      max-width: 600px;
      margin: 0 auto;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    }

    .form-container h2 {
      color: #333;
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 15px;
      text-align: left;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #333;
    }

    input[type="text"],
    input[type="time"],
    select,
    textarea {
      width: 100%;
      padding: 10px;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    input[readonly] {
      background-color: #f5f5f5;
      cursor: not-allowed;
    }

    button {
      background-color: #6f42c1;
      color: white;
      padding: 10px 20px;
      font-size: 1em;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: transform 0.3s;
    }

    button:hover {
      transform: scale(1.05);
      background-color: #5a3798;
    }

    .error {
      color: red;
      font-size: 0.9em;
      margin-top: 5px;
    }

    .success-message {
      color: green;
      font-size: 1.1em;
      margin-top: 10px;
    }

    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      header h1 {
        font-size: 1.5em;
      }

      button {
        font-size: 0.9em;
      }
    }
  </style>
</head>

<body>
  <header>
    <img src="https://i.imgur.com/wdj5VIH.png" alt="Money Plant Logo">
    <h1>Money Plant Link Pvt. Ltd.</h1>
  </header>

  <div class="form-container">
    <h2>Employee and ATM Data Management</h2>
    <form id="dataForm" onsubmit="handleSubmit(event)">
      <div class="form-group">
        <label for="Date">Date:</label>
        <input type="text" id="Date" readonly>
      </div>
      <div class="form-group">
        <label for="JobID">Employee ID:</label>
        <input type="text" id="JobID" placeholder="Enter Employee ID" oninput="updateEmployeeDetails()">
        <span id="EmployeeIDError" class="error"></span>
      </div>
      <div class="form-group">
        <label for="ExecutiveName">Executive Name:</label>
        <input type="text" id="ExecutiveName" readonly>
      </div>
      <div class="form-group">
        <label for="MobileNumber">Mobile Number:</label>
        <input type="text" id="MobileNumber" readonly>
      </div>
      <div class="form-group">
        <label for="Zone">Zone:</label>
        <input type="text" id="Zone" readonly>
      </div>
      <div class="form-group">
        <label for="ATMCRMID">ATM/CRM ID:</label>
        <input type="text" id="ATMCRMID" placeholder="Enter ATM/CRM ID" oninput="updateATMLocation()">
        <span id="ATMCRMIDError" class="error"></span>
      </div>
      <div class="form-group">
        <label for="ATMLOCATION">ATM Location:</label>
        <input type="text" id="ATMLOCATION" readonly>
      </div>
      <div class="form-group">
        <label for="TypeOfCall">Type Of Call:</label>
        <select id="TypeOfCall" name="TypeOfCall" required>
          <option value="">Select an option</option>
          <option value="Cash Jam">Cash Jam</option>
          <option value="Receive Paper">Receive Paper</option>
          <option value="Down">Down</option>
          <option value="Engineer Call">Engineer Call</option>
          <option value="PM">PM</option>
          <option value="Fast Load">Fast Load</option>
          <option value="Last Load">Last Load</option>
          <option value="Return">Return</option>
          <option value="Manual Cash Jam">Manual Cash Jam</option>
          <option value="ADC Call">ADC Call</option>
          <option value="Other’s">Other’s</option>
        </select>
      </div>
      <div class="form-group">
        <label for="InTime">ATM/CRM Open Time:</label>
        <input type="time" id="InTime" name="InTime" required>
      </div>
      <div class="form-group">
        <label for="OutTime">ATM/CRM Close Time:</label>
        <input type="time" id="OutTime" name="OutTime" required>
      </div>
      <div class="form-group">
        <label for="From">From:</label>
        <input type="text" id="From" name="From" placeholder="Enter your bill start location" required>
      </div>
      <div class="form-group">
        <label for="To">To:</label>
        <input type="text" id="To" name="To" placeholder="Enter your bill End location" required>
      </div>
      <div class="form-group">
        <label for="Transport">Transport:</label>
        <input type="text" id="Transport" name="Transport" placeholder="Enter What transport are you using?" required>
      </div>
      <div class="form-group">
        <label for="TravellingAmount">Travelling Amount:</label>
        <input type="text" id="TravellingAmount" name="TravellingAmount" placeholder="Enter Travelling Amount" required>
      </div>
      <div class="form-group">
        <label for="Person">How many people's bills?:</label>
        <select id="Person" name="Person" required>
          <option value="">Select an option</option>
          <option value="1 Person">1 Person</option>
          <option value="2 Person">2 Person</option>
        </select>
      </div>
      <div class="form-group">
        <label for="Remarks">Remarks:</label>
        <textarea id="Remarks" name="Remarks" placeholder="Enter any remarks here" required></textarea>
      </div>
      <button type="submit">Submit</button>
      <span id="formError" class="error"></span>
    </form>
    <div id="thankYouMessage" class="success-message" style="display: none;">Thank you! Your form has been submitted
      successfully.</div>
  </div>

  <script>
    const jobIdToName = {
      '144': 'Md. Rubel',
      '11765': 'Md. Suzon',
    };

    const jobIdToZone = {
      '144': 'Head Office',
      '11765': 'Uttara-1',
    };

    const jobIdToMobileNumber = {
      '144': '01958193400',
      '11765': '01812345678',
    };

    const atmIdToLocation = {
      'ATM001': 'Banani Branch',
      'ATM002': 'Gulshan-1 Branch',
    };

    function updateEmployeeDetails() {
      const jobId = document.getElementById('JobID').value.trim();
      const executiveName = jobIdToName[jobId] || '';
      const zone = jobIdToZone[jobId] || '';
      const mobileNumber = jobIdToMobileNumber[jobId] || '';

      document.getElementById('ExecutiveName').value = executiveName;
      document.getElementById('Zone').value = zone;
      document.getElementById('MobileNumber').value = mobileNumber;

      const errorSpan = document.getElementById('EmployeeIDError');
      errorSpan.textContent = executiveName ? '' : 'Invalid Employee ID!';
    }

    function updateATMLocation() {
      const atmId = document.getElementById('ATMCRMID').value.trim();
      const atmLocation = atmIdToLocation[atmId] || '';

      document.getElementById('ATMLOCATION').value = atmLocation;
      const errorSpan = document.getElementById('ATMCRMIDError');
      errorSpan.textContent = atmLocation ? '' : 'Invalid ATM/CRM ID!';
    }

    function handleSubmit(event) {
      event.preventDefault();
      const formError = document.getElementById('formError');
      formError.textContent = "Processing...";

      const formData = {
        Date: document.getElementById('Date').value,
        EmployeeID: document.getElementById('JobID').value,
        ExecutiveName: document.getElementById('ExecutiveName').value,
        MobileNumber: document.getElementById('MobileNumber').value,
        Zone: document.getElementById('Zone').value,
        ATMCRMID: document.getElementById('ATMCRMID').value,
        ATMLOCATION: document.getElementById('ATMLOCATION').value,
        TypeOfCall: document.getElementById('TypeOfCall').value,
        InTime: document.getElementById('InTime').value,
        OutTime: document.getElementById('OutTime').value,
        From: document.getElementById('From').value,
        To: document.getElementById('To').value,
        Transport: document.getElementById('Transport').value,
        TravellingAmount: document.getElementById('TravellingAmount').value,
        Person: document.getElementById('Person').value,
        Remarks: document.getElementById('Remarks').value
      };

      fetch('https://script.google.com/macros/s/AKfycbyZLFLID9UOO3yZpVgSlrq90mtLXy0dnNmwMV-XBQPHwJvkj9eT3l4ezUzsdAn3WB698g/exec', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
      })
        .then(response => response.json())
        .then(data => {
          formError.textContent = data.message; 
          if(data.success) {
            document.getElementById('thankYouMessage').style.display = 'block';
            document.getElementById('dataForm').style.display = 'none';
          }
        })
        .catch((error) => {
          formError.textContent = 'Submission failed! Please try again later.';
          console.error('Error:', error);
        });
    }

    // Set current date on load
    document.getElementById('Date').value = new Date().toLocaleDateString();
  </script>
</body>

</html>
